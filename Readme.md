# <p align="center">YiYan-PPT</p>

<p align="center"><i>
åŸºäºæ–‡å¿ƒä¸€è¨€çš„ä¸€é”®ç”ŸæˆPPTï¼Œæ“ä½œç®€å•ï¼Œæä¾›gradioä¸€é”®ç•Œé¢å’Œä¸€é”®å¯æ‰§è¡Œçš„pyæ–‡ä»¶



## ğŸ”¥ æ•ˆæœå±•ç¤º
> ![img.png](pptx_static/static/img.png)
> è¯¦æƒ…è¯·çœ‹./myppt/ æ–‡ä»¶å¤¹ä¸‹çš„pptxï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯ä¸“é—¨ç”¨æ¥å­˜æ”¾ç”Ÿæˆçš„PPTçš„ã€‚

## ğŸï¸ é¡¹ç›®ä»‹ç» 

> ä¸€é”®ç”ŸæˆPPTï¼ŒåŸºäºç”¨æˆ·çš„ä»»åŠ¡åç§°ç”ŸæˆPPTæ–‡å­—å¤§çº²ï¼Œå°†æ–‡å­—å¤§çº²è§£ææˆæ ‘çš„ç»“æ„ï¼Œå†å¯¹è¯¥æ ‘è¿›è¡Œæ·±åº¦éå†æœç´¢ï¼Œé€ä¸€ç”Ÿæˆå¯¹åº”å¹»ç¯ç‰‡ã€‚

> æœ¬é¡¹ç›®ä¸»è¦æ˜¯åŸºäºhttps://github.com/limaoyi1/Auto-PPT ï¼Œ æ–‡æœ¬è§£ææˆæ ‘ç»“æ„å’ŒåŸºäºæ ‘ç»“æ„ç”ŸæˆPPTçš„ç›¸å…³ä»£ç åœ¨./mdtreeæ–‡ä»¶å¤¹ä¸‹ï¼Œåœ¨æ­¤è¡¨ç¤ºæ„Ÿè°¢ï¼

> æœ¬é¡¹ç›®å®Œå…¨ç”±ç™¾åº¦æ–‡å¿ƒä¸€è¨€æä¾›APIæ”¯æŒï¼Œå……åˆ†åˆ©ç”¨äº†æ–‡å¿ƒä¸€è¨€APIåœ¨å›½å†…ç”Ÿæˆé€Ÿåº¦å¿«ï¼Œæ•ˆæœä¼˜ç§€çš„ä¼˜åŠ¿ã€‚

>  PPTæ¶‰åŠçš„å›¾åƒæ¥æºæ˜¯é€šè¿‡ç™¾åº¦å›¾åƒæœç´¢çˆ¬å–çš„ã€‚

## â­ ä¸€é”®ä½¿ç”¨

![gradio.png](pptx_static/static/gradio.png)

> æˆ‘ä½¿ç”¨çš„pythonç‰ˆæœ¬æ˜¯3.10,ç„¶åä¸»è¦ä¾èµ–åŒ…åœ¨requirements.txtã€‚

> pip install -r requirements.txt

> è¯·åœ¨config.pyé…ç½®å¥½è‡ªå·±çš„API_Keyå’ŒSecret_Keyï¼Œè‹¥ä¸ä¼šè¯·å‚è€ƒ[è·å–access_token](https://cloud.baidu.com/doc/WENXINWORKSHOP/s/Ilkkrb0i5)ã€‚

> gradioç•Œé¢è¯·ä¸€é”®è¿è¡Œgradio_test.py,å°±æ˜¯æƒ³ä¸€é”®è¿è¡Œçš„å¯ä»¥ç›´æ¥è¿è¡Œtest.pyã€‚



## ğŸ§² é¡¹ç›®ä¼˜åŠ¿

> ğŸŒŸ ç®€å•çš„è¾“å…¥æ ‡é¢˜ï¼Œä¸€é”®ç”ŸæˆPPTã€‚åŒæ—¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡AIçš„åé—®ï¼Œç»™ä»»åŠ¡æ·»åŠ ä¸€äº›è¡¥å……ä¿¡æ¯ã€‚

> ğŸ© å›½å†…LLM APIè¿˜å¾—çœ‹ç™¾åº¦ï¼Œä½¿ç”¨ernie-botã€‚

> ğŸ’¡ å±‚æ¬¡åŒ–ç”Ÿæˆæ–‡å­—å¤§çº²ï¼Œæ”¯æŒå­ä¸»é¢˜ä¸ªæ•°çš„æ§åˆ¶ï¼Œè¿™éƒ¨åˆ†ä»£ç è¯¦è§[structure_article.py](./structure_article.py).æ¸…æ™°æ˜äº†ã€‚

> ğŸ–¼ï¸ æ ¸å¿ƒå…³äºåŸºäºæ ‘ç»“æ„ç”ŸæˆPPTä»£ç åœ¨[./mdtree/tree2ppt.py](./mdtree/tree2ppt.py)ã€‚

> ğŸ”’ ä»£ç ç»“æ„æ¸…æ™°ç®€å•ï¼Œå¾ˆå¥½ç†è§£ï¼Œåç»­å°†æ”¾ç½®è®²è§£çš„PDFåœ¨é¡¹ç›®ä¸­ã€‚

## ğŸ’¡ç›¸å…³æ–‡ä»¶ä»‹ç» ä»¥åŠ ä¸€äº›æ”¹è¿›ä»‹ç»

> ./mdtree/tree2ppt.py æ˜¯æœ€å…³é”®çš„å°†æ–‡æœ¬å¤§çº²ï¼ˆMarkdownæ ¼å¼ï¼‰è½¬å˜ä¸ºå…·ä½“çš„PPTçš„PYæ–‡ä»¶ï¼Œæˆ‘ä¸»è¦å°†PPTé¦–é¡µå¹»ç¯ç‰‡è¿›è¡Œå•ç‹¬ç”Ÿæˆï¼ŒåŒæ—¶ä¸ºäº†é˜²æ­¢æŸä¸ªå­ä¸»é¢˜ï¼ˆæˆ–å­å­™ä¸»é¢˜ï¼‰ä¸‹çš„æ­£æ–‡å†…å®¹å¤ªé•¿ï¼Œæˆ‘è´´å¿ƒçš„è¿›è¡Œäº†æ­£æ–‡åˆ†æ®µå¤„ç†ï¼Œæ”¾åœ¨2é¡µï¼ˆæˆ–è€…å¤šé¡µï¼‰å¹»ç¯ç‰‡è¿›è¡Œå±•ç¤ºã€‚
```python
#./mdtree/tree2ppt.py 
            content_list = heading.source.split("\n\n")#heading.sourceå³ä¸ºæ­£æ–‡éƒ¨åˆ†
            content_max_word_num = 250
            begin_index = 0
            input_text_list = []
            while begin_index < len(content_list):
                # print("begin_index", begin_index, "æ‰€æœ‰å…ƒç´ ä¸ªæ•°", len(ele_text_list))
                input_token_i = 0
                input_text = ""
                for i in range(begin_index, len(content_list)):
                    if len(content_list[i]) + input_token_i < content_max_word_num:
                        input_text += "\n"+content_list[i]
                        input_token_i += len(content_list[i])
                        begin_index = i
                    else:
                        if input_token_i==0:#é˜²æ­¢æŸä¸€æ®µé•¿åº¦ç›´æ¥å¤§äºæ­£æ–‡æœ€å¤§é•¿åº¦ï¼Œå°±è¢«è·³è¿‡äº†ã€‚
                            input_text +=content_list[i]
                        break
                begin_index += 1
                input_text_list.append(input_text)

            for content_i in range(len(input_text_list)):
                if content_i==0:
                    if self.theme_param["main_page"].get("img_info") and len(self.img_dicts)>0:
                        img_dict = self.img_dicts[random.randint(0, len(self.img_dicts) - 1)]
                    else:
                        img_dict = {}
                    MD2Slide(self.prs, self.theme, heading.text, img_dict=img_dict,content=input_text_list[content_i].strip())
                else:
                    if self.theme_param["main_page"].get("img_info") and len(self.img_dicts)>0:
                        img_dict = self.img_dicts[random.randint(0, len(self.img_dicts) - 1)]
                    else:
                        img_dict = {}
                    MD2Slide(self.prs, self.theme, "", img_dict=img_dict,content=input_text_list[content_i].strip())
```

> ./mdtree/img_search.py æ˜¯åŸºäºç™¾åº¦çš„å›¾ç‰‡çˆ¬å–ä»£ç 

> pptæ¨¡æ¿æ˜¯åœ¨./my_ppt_modeæ–‡ä»¶å¤¹ä¸‹ï¼Œæä¾›2ä»½æ¨¡æ¿ï¼Œ./my_ppt_mode/1 æ˜¯æœ‰æ–‡å›¾çš„ï¼Œ ./my_ppt_mode/2 æ˜¯çº¯æ–‡å­—çš„æ¨¡æ¿ï¼Œ

> ä»¥./my_ppt_mode/1çš„æ–‡ä»¶å¤¹ç›®å½•ä¸‹æ–‡ä»¶ä¸¾ä¾‹ï¼Œtitle.pngæ˜¯æŒ‡PPTé¦–é¡µçš„å›¾åƒï¼Œè¯¦ç»†å…³äºPPTæ¨¡æ¿çš„è¯¦ç»†å‚æ•°ä¿å­˜åœ¨mode.jsonä¸­ï¼Œä¸»è¦åˆ†æˆslide_sizeï¼ˆè®¾ç½®PPTæ¯é¡µå¹»ç¯ç‰‡çš„é•¿å®½å°ºå¯¸ï¼‰ï¼Œfirst_pageï¼ˆé¦–é¡µçš„ä¿¡æ¯ï¼‰ï¼Œcatalog_pageï¼ˆç›®å½•é¡µçš„ä¿¡æ¯ï¼Œç›®å½•é¡µçš„æ­£æ–‡éƒ¨åˆ†ç›´æ¥å‚è€ƒmain_pageï¼‰ï¼Œmain_page(æ­£æ–‡éƒ¨åˆ†) å››å¤§éƒ¨åˆ†ï¼Œå¦‚æœmain_pageä¸­æ²¡æœ‰img_infoï¼Œåˆ™æŒ‡è¯¥æ¨¡æ¿ä¸å¸¦å›¾ç‰‡çº¯æ–‡å­—ã€‚

> img/ æ–‡ä»¶å¤¹ä¸ºPPTéé¦–é¡µçš„èƒŒæ™¯å›¾ç‰‡ï¼Œæ¯å¼ å¹»ç¯ç‰‡éšæœºæŠ½å–å…¶ä¸­ä¸€å¼ ã€‚

## ğŸŒŸ Star History



[![Star History Chart](https://api.star-history.com/svg?repos=hl123-123/Yiyan-PPT&type=Timeline)](https://star-history.com/#hl123-123/Yiyan-PPT&Timeline)


